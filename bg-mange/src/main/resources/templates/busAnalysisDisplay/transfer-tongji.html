<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,height=device-height, minimum-scale=1.0, maximum-scale=1.0">
    <title>换乘量统计</title>
    <link rel="stylesheet" type="text/css" th:href="@{/static/busAnalysisDisplay/css/style.css}" />
    <script  th:src="@{/static/busAnalysisDisplay/js/jquery-1.11.1.min.js}"></script>
    <script type="text/javascript">
        (function(){
            function sizeHtml(){
                window.mtSizeBase = $(window).width()/32;
                //window.mtSizeBase = window.mtSizeBase>45?45:window.mtSizeBase;
                $("html").css("font-size",window.mtSizeBase+"px");
            }
            sizeHtml();
            $(window).resize(function(){
                setTimeout(function(){
                    sizeHtml();
                },300);
            });
        })();

    </script>
</head>
<body class="common-bg" style="overflow:hidden;">
<h3 class="head-img"></h3>
<div class="content-body">
    <div class="nav-crosswise">
        <div class="nav-crosswise-main c-fff"><span>当前位置</span>><span>数据分析</span>><span>换乘分析</span>><span>换乘量统计</span></div>
    </div>
    <div class="main-area clearfix">
        <div class="lengthways-nav fl" id="side-menu">
            <div class="map-show-nav selected">
                <ul>
                    <li>
                        <span class="J_menuItem"><img th:src="@{/static/busAnalysisDisplay/images/quan.png}">地图展示</span>
                        <ul>
                            <li><a href="traffic-monitoring.html" th:href="@{/page/passengerFlowMonitor}">客流监控</a></li>
                            <li><a href="car-monitoring.html" th:href="@{/page/busMonitor}">车辆监控</a></li>
                            <li><a href="car-transfer.html" th:href="@{/page/busTransform}">车辆换乘</a></li>
                            <li><a href="od-fenbu.html" th:href="@{/page/regionODDistri}">区域OD分布</a></li>
                            <li><a href="alarm-msg.html" th:href="@{/page/alarmMsg}">报警信息</a></li>
                        </ul>
                    </li>
                    <li  class="active">
                        <span class="J_menuItem"><img th:src="@{/static/busAnalysisDisplay/images/quan.png}">数据分析</span>
                        <ul>
                            <li>
                                <span class="J_menuItem">公交客运</span>
                                <ul>
                                    <li><a href="passenger-form.html" th:href="@{/page/passenVolumeCons}">客运量构成</a></li>
                                    <li><a href="brush-card-number.html" th:href="@{/page/swingCardVolumeStati}">刷卡量统计</a></li>
                                </ul>
                            </li>
                            <li>
                                <span class="J_menuItem">公交运行</span>
                                <ul>
                                    <li><a href="gaofeng-chart.html" th:href="@{/page/peakRun}">高峰运行图</a></li>
                                    <li><a href="running-speed-chart.html" th:href="@{/page/runSpeedStati}">运行速度统计</a></li>
                                    <li><a href="traffic-zhishu.html" th:href="@{/page/trafficNum}">交通指数</a></li>
                                    <li><a href="traffic-routes.html" th:href="@{/page/congestionRoad}">拥堵路段</a></li>
                                </ul>
                            </li>
                            <li class="active">
                                <span class="J_menuItem">换乘分析</span>
                                <ul>
                                    <li><a href="transfer-form.html" th:href="@{/page/transChangeCons}">换乘量构成</a></li>
                                    <li><a class="on">换乘量统计</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>

        </div>
        <div class="map-area fr " id="content">
            <div class="data-area  brush-card-number">
                <ul class="car-num-title clearfix">
                    <li class="cur">小时变化</li>
                    <li>日变化</li>
                    <li>月变化</li>
                </ul>
                <ul class="car-num-main" style="position: relative">
                    <li class="active">
                        <div class="clearfix car-num-data-wrap">
                            <div class="past-data fl">
                                <div class="circle-out blue-out">
                                    <div class="circle-inner blue-inner c-fff">
                                        <p id="hourPre">740</p>万人次
                                    </div>
                                </div>
                                <p class="c-fff" >前一日</p>
                            </div>
                            <div class="current-data fl">
                                <div class="circle-out red-out">
                                    <div class="circle-inner red-inner c-fff">
                                        <p id="hourCurrent">740</p>万人次
                                    </div>
                                </div>
                                <p class="c-fff" >今日</p>

                            </div>
                            <div class="same-time-data fl">
                                <div class="circle-out yellow-out">
                                    <div class="circle-inner yellow-inner c-fff">
                                        <p id="hourLastWeek">740</p>万人次
                                    </div>
                                </div>
                                <p class="c-fff" >上周同期</p>
                            </div>
                        </div>
                        <!--<img src="images/car-num.png" />-->
                        <!--小时变化-->
                        <div id="timeChangChart" class="chartStyle"></div>
                    </li>
                    <li>
                        <div class="clearfix car-num-data-wrap">
                            <div class="past-data fl">
                                <div class="circle-out blue-out">
                                    <div class="circle-inner blue-inner c-fff">
                                        <p id="dayPre">740</p>万人次
                                    </div>
                                </div>
                                <p class="c-fff">前一月</p>
                            </div>
                            <div class="current-data fl">
                                <div class="circle-out red-out">
                                    <div class="circle-inner red-inner c-fff">
                                        <p id="dayCurrent">740</p>万人次
                                    </div>
                                </div>
                                <p class="c-fff">今月</p>

                            </div>
                            <div class="same-time-data fl">
                                <div class="circle-out yellow-out">
                                    <div class="circle-inner yellow-inner c-fff">
                                        <p id="dayLastYear">740</p>万人次
                                    </div>
                                </div>
                                <p class="c-fff">上年同期</p>
                            </div>
                        </div>
                        <!--<img src="images/car-num.png" />-->
                        <!--天时变化-->
                        <div id="dayChangChart" class="chartStyle"></div>
                    </li>
                    <li>
                        <div class="clearfix car-num-data-wrap">
                            <div class="past-data fl">
                                <div class="circle-out blue-out">
                                    <div class="circle-inner blue-inner c-fff">
                                        <p id="monthLastYear">740</p>亿人次
                                    </div>
                                </div>
                                <p class="c-fff">2017年</p>
                            </div>
                            <div class="current-data fl">
                                <div class="circle-out red-out">
                                    <div class="circle-inner red-inner c-fff">
                                        <p id="monthCurrentYear">740</p>亿人次
                                    </div>
                                </div>
                                <p class="c-fff">2018年</p>

                            </div>
                            <div class="same-time-data fl">
                                <div class="circle-out yellow-out">
                                    <div class="circle-inner yellow-inner c-fff">
                                        <p id="monthPreYear">740</p>亿人次
                                    </div>
                                </div>
                                <p class="c-fff">2016年</p>

                            </div>
                        </div>
                        <!--<img src="images/car-num.png" />                             -->
                        <!--月变化-->
                        <div id="monthChangChart" class="chartStyle"></div>
                    </li>
                </ul>
            </div>

        </div>
    </div>
</div>
</body>
<script type="text/javascript" th:replace="common/fragment :: commonVar"></script>
<script type="text/javascript" th:src="@{/static/js/echarts/echarts.min.js}"></script>
<script type="text/javascript" th:src="@{/static/js/ticcCommon.js}"></script>
<script type="text/javascript">

    //下面是页面的
    $(function(){
        var body = (document.compatMode && document.compatMode.toLowerCase() == "css1compat") ? document.documentElement : document.body;

        function ResizeTable() {
            var sideWidth = document.getElementById("side-menu");
            var con = document.getElementById('content');

            sideWidth.style.height = '' + Math.max((body.clientHeight - 100), 0) + "px";
            con.style.height = '' + Math.max((body.clientHeight - 100), 0) + "px";
            con.style.width = '' + Math.max((body.clientWidth - 180), 0) + "px";



        }
        ResizeTable();

        $(window).resize(function () {
            ResizeTable()
        });

        var $item = $(".J_menuItem");
        $item.on("click",function(){
            var $this = $(this);
            $this.siblings("ul").slideToggle(300);
            $this.parent("li").siblings("li").find("ul").slideUp(300);
            $this.parent("li").addClass("active").siblings("li").removeClass("active");
        })

        $(".car-num-title li").click(function() {
            var index = $(this).index();
            $(this).addClass('cur').siblings('li').removeClass('cur');
            //$(this).parent().siblings('ul').children().hide();
            $(this).parent().siblings('ul').children().eq(index).addClass("active").siblings().removeClass("active");
        });


    })

    $(function () {
        /**********************/

        // var color = '#075480';
        var splitLineColor = '#075480';
        var color = '#FFFFFF';
        var lineColor = '#0a324b';
        var  timeChangChartXAxisData = ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12','13','14','15','16',
            '17','18','19','20','21','22','23','24'];
        var  dayChangChartXAxisData = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12','13','14','15','16',
            '17','18','19','20','21','22','23','24','25','26','27','28','29','30','31'];
        var  monthChangChartXAxisData = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
        // var seriesData = [45, 55, 70, 95, 55, 70, 85];
        var scale = 0.8;

        var maxData = '55%';
        //线的item样式
        var lineItemStyle = {
            normal: {
                lineStyle:{
                    width:0.8
                }
            }
        };

        /*小时变化开始*/
        var compare = function (obj1, obj2) {
            var val1 = obj1.name;
            var val2 = obj2.name;
            if (val1 < val2) {
                return -1;
            } else if (val1 > val2) {
                return 1;
            } else {
                return 0;
            }
        };
        var displayTimeChangChart = function (data) {

//            currentStationFlow
//            currentStationFlowSum
//            preStationFlow
//            preStationFlowSum
//            lastWeekStationFlow
//            lastWeekStationFlowSum
            var currentFlow = $.map(data.currentFlow,function (item,index) {
                return{
                    name: index,
                    value: item
                }
            });
            var preFlow = $.map(data.preFlow,function (item,index) {
                return{
                    name: index,
                    value: item
                }
            });
            var lastWeekFlow = $.map(data.lastWeekFlow,function (item,index) {
                return{
                    name: index,
                    value: item
                }
            });
            var chartData = {
                current:currentFlow.sort(compare),
                pre:preFlow.sort(compare),
                lastWeek:lastWeekFlow.sort(compare)
//                pre:data.preStationFlow,
//                lastWeek:data.lastWeekStationFlow
            };

            // 基于准备好的dom，初始化echarts实例
            var timeChangChart = echarts.init(document.getElementById('timeChangChart'));

            var timeChangChartOption = {
                tooltip: {
                    show: true, //去除面板显示
                    trigger: 'axis',
                    axisPointer: {
                        /*                    'line' 直线指示器
                                            'shadow' 阴影指示器
                                            'cross' 十字准星指示器。其实是种简写，表示启用两个正交的轴的 axisPointer。*/
                        type: 'shadow',
                        label: {
                            backgroundColor: '#185164'
                        }
                    }
                },
                legend: {//图例组件
                    show: true,
                    right:40,
                    bottom:10,
                    itemGap:10,
                    data: ['前一日', '今日','上周同期'],
                    icon: 'roundRect',
                    itemWidth:20,
                    itemHeight:9,
                    textStyle: {
                        color: '#ffffff',
                        // fontSize:16*scale,
                        fontSize:14*scale,
                        // height:50,
                        // padding: [0, 0, 600, 0]
                    },
                },
                backgroundColor: '#031F35',
                // color: ['#295beb', '#eb297d','#ffc72b'], //3dd3f8
                color: ['#0BB3FE', '#FF3B59','#FEEA1D'], //3dd3f8
                grid: {//直角坐标系内绘图网格
                    left: '3%',
                    right: '10%',
                    top:'20%',
                    bottom: '20%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    axisLabel: {
                        textStyle: {
                            color: color,
                            fontSize: 16*scale
                        },
                        // rich: {
                        //     x: {
                        //         fontSize: 18,
                        //         fontFamily: 'Microsoft YaHei',
                        //         borderColor: '#449933',
                        //         borderRadius: 4
                        //     }
                        // }
                    },
                    axisLine: {
                        lineStyle: {
                            color: lineColor
                        }
                    },
                    // splitLine: {
                    //     show: true,
                    //     lineStyle:{
                    //         color: lineColor
                    //     }
                    // },
                    // name: '月',
                    nameTextStyle: {
                        color: color,
                        fontSize: 16*scale,
                        padding: [0, 0, 0, 10]
                    },
                    data: timeChangChartXAxisData
                },
                yAxis: {
                    type: 'value',
//                    max: 100,
                    axisLabel: {
                        padding: [0, 15, 0, 0],
                        textStyle: {
                            color: color,
                            fontSize: 16*scale
                        },
                        formatter:function (value) {
                            return parseFloat(value/10000);
                        }
                    },
                    axisLine: {
                        lineStyle: {
                            color: lineColor
                        }
                    },
                    splitLine: {
                        show: true,
                        lineStyle:{
                            color: lineColor
                        }
                    },
                    // splitLine: {
                    //     show: false
                    // },
                    name: '万人',
                    nameTextStyle: {
                        color: color,
                        fontSize: 16*scale,
                        // padding: [0, 0, -25, 0]
//                    padding: [0, 60, -220, 0]//表示 [上, 右, 下, 左] 的边距。
                    }
                },
                series: [{
                    name: '前一日',
                    type: 'line',
                    stack: '总量',
                    smooth: true, //这句就是让曲线变平滑的
                    data: chartData.pre,
                    symbol: 'none', //拐点样式
                    itemStyle: lineItemStyle,
                    markPoint: {
                        data: [
                            {
                                symbol:'circle',
                                type: 'max',
                                symbolSize: [5, 5],
                                itemStyle: {
                                    normal: {
                                        color: "#295beb",
                                        borderColor:'rgba(41, 91,235, 0.3)',//rgba(255, 199, 43, .3)
                                        borderWidth:10*scale,
                                        shadowColor:'#295beb',
                                        shadowBlur:30,
                                    }
                                },
                                label: {
                                    normal: {
                                        show: false
                                    }
                                }
                            }]
                    },
                    /*                lineStyle:{
                                        color:"#ffffff",
                                        width:10,
                                        type:'dotted'
                                    }*/

                }, {
                    name: '今日',
                    type: 'line',
                    smooth: true, //这句就是让曲线变平滑的
                    data: chartData.current,
                    symbol: 'none', //拐点样式
                    itemStyle: lineItemStyle,
                    markPoint: {
                        data: [
                            {
                                symbol:'circle',
                                type: 'max',
                                symbolSize: [5, 5],
                                itemStyle: {
                                    normal: {
                                        color: "#eb297d",
                                        borderColor:'rgba(235,41,125,0.3)',//rgba(255, 199, 43, .3)
                                        borderWidth:10*scale,
                                        shadowColor:'#eb297d',
                                        shadowBlur:30
                                    }
                                },
                                label: {
                                    normal: {
                                        show: false
                                    }
                                }
                            }]
                    }
                },
                    {
                        name: '上周同期',
                        type: 'line',
                        smooth: true, //这句就是让曲线变平滑的
                        data: chartData.lastWeek,
                        symbol: 'none', //拐点样式
                        itemStyle: lineItemStyle,
                        markPoint: {
                            data: [
                                {
                                    symbol:'circle',
                                    type: 'max',
                                    symbolSize: [5, 5],
                                    itemStyle: {
                                        normal: {
                                            color: "#ffc72b",
                                            borderColor:'rgba(255, 199, 43, 0.3)',//rgba(255, 199, 43, .3)
                                            borderWidth:10*scale,
                                            shadowColor:'#ffc72b',
                                            shadowBlur:30
                                        }
                                    },
                                    label: {
                                        normal: {
                                            show: false
                                        }
                                    }
                                }]
                        }
                    }]
            };

            // 使用刚指定的配置项和数据显示图表。
            timeChangChart.setOption(timeChangChartOption);
        };
        var requestTimeChangChart = function () {
            var path = basePath+'/redis/getTransferHourChangeFlow';
            var param = {'date':new Date()};
            ticc.ajaxRequest(path,param,function (result) {
                if (result.status){
                    if (!ticc.isNullOrEmpty(result.data)){
//                        alert(JSON.stringify(result.data));
                        var currentFlowSum = parseFloat(result.data.currentFlowSum/10000);
                        $('#hourCurrent').text(currentFlowSum);
                        var preFlowSum = parseFloat(result.data.preFlowSum/10000);
                        $('#hourPre').text(preFlowSum);
                        var lastWeekFlowSum = parseFloat(result.data.lastWeekFlowSum/10000);
                        $('#hourLastWeek').text(lastWeekFlowSum);

                        displayTimeChangChart(result.data);
                    }else{
                        ticc.alertInfo(result.msg);
                    }
                }else{
                    ticc.alertError(result.msg);
                }
            });
        };

        /*小时变化结束*/

        /**********************/

        /*日变化开始*/
        var displayDayChangChart = function (data) {
//            currentStationFlowDay
//            currentStationFlowSumDay
//            preStationFlowDay
//            preStationFlowSumDay
//            lastYearStationFlowDay
//            lastYearStationFlowSumDay

            var currentFlow = $.map(data.currentFlowDay,function (item,index) {
                return{
                    name: index,
                    value: item
                }
            });
            var preFlow = $.map(data.preFlowDay,function (item,index) {
                return{
                    name: index,
                    value: item
                }
            });
            var lastYearFlow = $.map(data.lastYearFlowDay,function (item,index) {
                return{
                    name: index,
                    value: item
                }
            });

            var chartData = {
                current:currentFlow.sort(compare),
                pre:preFlow.sort(compare),
                lastYear:lastYearFlow.sort(compare)
            };

            // 基于准备好的dom，初始化echarts实例
            var dayChangChart = echarts.init(document.getElementById('dayChangChart'));

            var dayChangChartOption = {
                tooltip: {
                    show: true, //去除面板显示
                    trigger: 'axis',
                    axisPointer: {
                        /*                    'line' 直线指示器
                                            'shadow' 阴影指示器
                                            'cross' 十字准星指示器。其实是种简写，表示启用两个正交的轴的 axisPointer。*/
                        type: 'shadow',
                        label: {
                            backgroundColor: '#185164'
                        }
                    }
                },
                legend: {//图例组件
                    show: true,
                    right:40,
                    bottom:10,
                    itemGap:10,
                    data: ['上一月', '当月','去年同期'],
                    // icon: 'roundRect',
                    // icon: 'path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z',
                    itemWidth:20,
                    itemHeight:9,
                    textStyle: {
                        color: '#ffffff',
                        // fontSize:16*scale,
                        fontSize:14*scale,
                        // height:50,
                        // padding: [0, 0, 600, 0]
                    },
                },
                backgroundColor: '#031F35',
                // color: ['#295beb', '#eb297d','#ffc72b'], //3dd3f8
                color: ['#0BB3FE', '#FF3B59','#FEEA1D'], //3dd3f8
                grid: {//直角坐标系内绘图网格
                    left: '3%',
                    right: '10%',
                    top:'20%',
                    bottom: '20%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    axisLabel: {
                        textStyle: {
                            color: color,
                            fontSize: 16*scale
                        },
                        // rich: {
                        //     x: {
                        //         fontSize: 18,
                        //         fontFamily: 'Microsoft YaHei',
                        //         borderColor: '#449933',
                        //         borderRadius: 4
                        //     }
                        // }
                    },
                    axisLine: {
                        lineStyle: {
                            color: lineColor
                        }
                    },
                    // splitLine: {
                    //     show: true,
                    //     lineStyle:{
                    //         color: lineColor
                    //     }
                    // },
                    // name: '月',
                    nameTextStyle: {
                        color: color,
                        fontSize: 16*scale,
                        padding: [0, 0, 0, 10]
                    },
                    data: dayChangChartXAxisData
                },
                yAxis: {
                    type: 'value',
//                    max: 100,
                    axisLabel: {
                        padding: [0, 15, 0, 0],
                        textStyle: {
                            color: color,
                            fontSize: 16*scale
                        },
                        formatter:function (value) {
                            return parseFloat(value/10000);
                        }
                    },
                    axisLine: {
                        lineStyle: {
                            color: lineColor
                        }
                    },
                    splitLine: {
                        show: true,
                        lineStyle:{
                            color: lineColor
                        }
                    },
                    // splitLine: {
                    //     show: false
                    // },
                    name: '万人',
                    nameTextStyle: {
                        color: color,
                        fontSize: 16*scale,
                        // padding: [0, 0, -25, 0]
//                        padding: [0, 60, -220, 0]//表示 [上, 右, 下, 左] 的边距。
                    }
                },
                series: [{
                    name: '上一月',
                    type: 'line',
                    stack: '总量',
                    smooth: false, //这句就是让曲线变平滑的
                    data: chartData.pre,
                    symbol: 'circle', //拐点样式
                    itemStyle: lineItemStyle,
                    markPoint: {
                        data: [
                            {
                                symbol:'circle',
                                type: 'max',
                                symbolSize: [5, 5],
                                itemStyle: {
                                    normal: {
                                        color: "#295beb",
                                        borderColor:'rgba(41, 91,235, 0.3)',//rgba(255, 199, 43, .3)
                                        borderWidth:10*scale,
                                        shadowColor:'#295beb',
                                        shadowBlur:30,
                                    }
                                },
                                label: {
                                    normal: {
                                        show: false
                                    }
                                }
                            }]
                    },
                    /*                lineStyle:{
                                        color:"#ffffff",
                                        width:10,
                                        type:'dotted'
                                    }*/

                }, {
                    name: '当月',
                    type: 'line',
                    smooth: false, //这句就是让曲线变平滑的
                    data: chartData.current,
                    symbol: 'circle', //拐点样式
                    itemStyle: lineItemStyle,
                    markPoint: {
                        data: [
                            {
                                symbol:'circle',
                                type: 'max',
                                symbolSize: [5, 5],
                                itemStyle: {
                                    normal: {
                                        color: "#eb297d",
                                        borderColor:'rgba(235,41,125,0.3)',//rgba(255, 199, 43, .3)
                                        borderWidth:10*scale,
                                        shadowColor:'#eb297d',
                                        shadowBlur:30
                                    }
                                },
                                label: {
                                    normal: {
                                        show: false
                                    }
                                }
                            }]
                    }
                },
                    {
                        name: '去年同期',
                        type: 'line',
                        smooth: false, //这句就是让曲线变平滑的
                        data: chartData.lastYear,
                        symbol: 'circle', //拐点样式
                        itemStyle: lineItemStyle,
                        markPoint: {
                            data: [
                                {
                                    symbol:'circle',
                                    type: 'max',
                                    symbolSize: [5, 5],
                                    itemStyle: {
                                        normal: {
                                            color: "#ffc72b",
                                            borderColor:'rgba(255, 199, 43, 0.3)',//rgba(255, 199, 43, .3)
                                            borderWidth:10*scale,
                                            shadowColor:'#ffc72b',
                                            shadowBlur:30
                                        }
                                    },
                                    label: {
                                        normal: {
                                            show: false
                                        }
                                    }
                                }]
                        }
                    }]
            };
            // 使用刚指定的配置项和数据显示图表。
            dayChangChart.setOption(dayChangChartOption);
        };
        var requestDayChangChart = function () {
            var path = basePath+'/redis/getTransferDayChangeFlow';
            var param = {'date':new Date()};
            ticc.ajaxRequest(path,param,function (result) {
                if (result.status){
                    if (!ticc.isNullOrEmpty(result.data)){
//                        alert(JSON.stringify(result.data));
                        var currentFlowSumDay = parseFloat(result.data.currentFlowSumDay/10000);
                        $('#dayCurrent').text(currentFlowSumDay);
                        var preFlowSumDay = parseFloat(result.data.preFlowSumDay/10000);
                        $('#dayPre').text(preFlowSumDay);
                        var lastYearFlowSumDay = parseFloat(result.data.lastYearFlowSumDay/10000);
                        $('#dayLastYear').text(lastYearFlowSumDay);

                        displayDayChangChart(result.data);
                    }else{
                        ticc.alertInfo(result.msg);
                    }
                }else{
                    ticc.alertError(result.msg);
                }
            });
        };
        /*日变化结束*/
        /**********************/

        /*月变化开始*/

        var displayMonthChangChart = function (data) {

//            currentStationFlowMonth
//            currentStationFlowSumMonth
//            lastYearStationFlowMonth
//            lastYearStationFlowSumMonth
//            preYearStationFlowMonth
//            preYearStationFlowSumMonth


            var currentYearFlow = $.map(data.currentYearFlowMonth,function (item,index) {
                return{
                    name: index,
                    value: item
                }
            });
            var lastYearFlow = $.map(data.lastYearFlowMonth,function (item,index) {
                return{
                    name: index,
                    value: item
                }
            });
            var preYearFlow = $.map(data.preYearFlowMonth,function (item,index) {
                return{
                    name: index,
                    value: item
                }
            });

            var chartData = {
                current:currentYearFlow.sort(compare),
                lastYear:lastYearFlow.sort(compare),
                preYear:preYearFlow.sort(compare)
            };

            // 基于准备好的dom，初始化echarts实例
            var monthChangChart = echarts.init(document.getElementById('monthChangChart'));
            var monthChangChartOption = {
                tooltip: {
                    show: true, //去除面板显示
                    trigger: 'axis',
                    axisPointer: {
                        /*                    'line' 直线指示器
                                            'shadow' 阴影指示器
                                            'cross' 十字准星指示器。其实是种简写，表示启用两个正交的轴的 axisPointer。*/
                        type: 'shadow',
                        label: {
                            backgroundColor: '#185164'
                        }
                    }
                },
                legend: {//图例组件
                    show: true,
                    right:40,
                    bottom:10,
                    itemGap:10,
                    data: ['2017年', '2018年','2016年'],
                    icon: 'roundRect',
                    itemWidth:20,
                    itemHeight:9,
                    textStyle: {
                        color: '#ffffff',
                        // fontSize:16*scale,
                        fontSize:14*scale,
                        // height:50,
                        // padding: [0, 0, 600, 0]
                    },
                },
                backgroundColor: '#031F35',
                // color: ['#295beb', '#eb297d','#ffc72b'], //3dd3f8
                color: ['#0BB3FE', '#FF3B59','#FEEA1D'], //3dd3f8
                grid: {//直角坐标系内绘图网格
                    left: '3%',
                    right: '10%',
                    top:'20%',
                    bottom: '20%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    axisLabel: {
                        textStyle: {
                            color: color,
                            fontSize: 16*scale
                        },
                        // rich: {
                        //     x: {
                        //         fontSize: 18,
                        //         fontFamily: 'Microsoft YaHei',
                        //         borderColor: '#449933',
                        //         borderRadius: 4
                        //     }
                        // }
                    },
                    axisLine: {
                        lineStyle: {
                            color: lineColor
                        }
                    },
                    // splitLine: {
                    //     show: true,
                    //     lineStyle:{
                    //         color: lineColor
                    //     }
                    // },
                    // name: '月',
                    nameTextStyle: {
                        color: color,
                        fontSize: 16*scale,
                        padding: [0, 0, 0, 10]
                    },
                    data: monthChangChartXAxisData
                },
                yAxis: {
                    type: 'value',
//                    max: 100,
                    axisLabel: {
                        padding: [0, 15, 0, 0],
                        textStyle: {
                            color: color,
                            fontSize: 16*scale
                        },
                        formatter:function (value) {
                            return parseFloat(value/10000);
                        }
                    },
                    axisLine: {
                        lineStyle: {
                            color: lineColor
                        }
                    },
                    splitLine: {
                        show: true,
                        lineStyle:{
                            color: lineColor
                        }
                    },
                    // splitLine: {
                    //     show: false
                    // },
                    name: '万人',
                    nameTextStyle: {
                        color: color,
                        fontSize: 16*scale,
                        // padding: [0, 0, -25, 0]
//                    padding: [0, 60, -220, 0]//表示 [上, 右, 下, 左] 的边距。
                    }
                },
                series: [{
                    name: (new Date().getFullYear()-1)+'年',
                    type: 'line',
                    stack: '总量',
                    smooth: true, //这句就是让曲线变平滑的
                    data: chartData.lastYear,
                    symbol: 'none', //拐点样式
                    itemStyle: lineItemStyle,
                    markPoint: {
                        data: [
                            {
                                symbol:'circle',
                                type: 'max',
                                symbolSize: [5, 5],
                                itemStyle: {
                                    normal: {
                                        color: "#295beb",
                                        borderColor:'rgba(41, 91,235, 0.3)',//rgba(255, 199, 43, .3)
                                        borderWidth:10*scale,
                                        shadowColor:'#295beb',
                                        shadowBlur:30,
                                    }
                                },
                                label: {
                                    normal: {
                                        show: false
                                    }
                                }
                            }]
                    },
                    /*                lineStyle:{
                                        color:"#ffffff",
                                        width:10,
                                        type:'dotted'
                                    }*/

                }, {
                    name: (new Date().getFullYear())+'年',
                    type: 'line',
                    smooth: true, //这句就是让曲线变平滑的
                    data: chartData.current,
                    symbol: 'none', //拐点样式
                    itemStyle: lineItemStyle,
                    markPoint: {
                        data: [
                            {
                                symbol:'circle',
                                type: 'max',
                                symbolSize: [5, 5],
                                itemStyle: {
                                    normal: {
                                        color: "#eb297d",
                                        borderColor:'rgba(235,41,125,0.3)',//rgba(255, 199, 43, .3)
                                        borderWidth:10*scale,
                                        shadowColor:'#eb297d',
                                        shadowBlur:30
                                    }
                                },
                                label: {
                                    normal: {
                                        show: false
                                    }
                                }
                            }]
                    }
                },
                    {
                        name: (new Date().getFullYear() - 2)+'年',
                        type: 'line',
                        smooth: true, //这句就是让曲线变平滑的
                        data: chartData.preYear,
                        symbol: 'none', //拐点样式
                        itemStyle: lineItemStyle,
                        markPoint: {
                            data: [
                                {
                                    symbol:'circle',
                                    type: 'max',
                                    symbolSize: [5, 5],
                                    itemStyle: {
                                        normal: {
                                            color: "#ffc72b",
                                            borderColor:'rgba(255, 199, 43, 0.3)',//rgba(255, 199, 43, .3)
                                            borderWidth:10*scale,
                                            shadowColor:'#ffc72b',
                                            shadowBlur:30
                                        }
                                    },
                                    label: {
                                        normal: {
                                            show: false
                                        }
                                    }
                                }]
                        }
                    }]
            };
            // 使用刚指定的配置项和数据显示图表。
            monthChangChart.setOption(monthChangChartOption);
            /*月变化结束*/

        };
        var requestMonthChangChart = function () {
            var path = basePath+'/redis/getTransferMonthChangeFlow';
            var param = {'date':new Date()};
            ticc.ajaxRequest(path,param,function (result) {
                if (result.status){
                    if (!ticc.isNullOrEmpty(result.data)){
//                        alert(JSON.stringify(result.data));
                        var currentYearFlowSumMonth = parseFloat(result.data.currentYearFlowSumMonth/100000000);
                        $('#monthCurrentYear').text(currentYearFlowSumMonth);
                        var lastYearFlowSumMonth = parseFloat(result.data.lastYearFlowSumMonth/100000000);
                        $('#monthLastYear').text(lastYearFlowSumMonth);
                        var preYearFlowSumMonth = parseFloat(result.data.preYearFlowSumMonth/100000000);
                        $('#monthPreYear').text(preYearFlowSumMonth);
                        displayMonthChangChart(result.data);
                    }else{
                        ticc.alertInfo(result.msg);
                    }
                }else{
                    ticc.alertError(result.msg);
                }
            });
        };


        /*月变化结束*/

        //tab切换
        $(".car-num-title li").click(function() {
            var index = $(this).index();
            $(this).addClass('cur').siblings('li').removeClass('cur');
            //$(this).parent().siblings('ul').children().hide();
            $(this).parent().siblings('ul').children().eq(index).addClass("active").siblings().removeClass("active");

            switch (index){
                case 0:
                    requestTimeChangChart();
                    break;
                case 1:
                    requestDayChangChart();
                    break;
                case 2:
                    requestMonthChangChart();
                    break;
            }
        });

        requestTimeChangChart();
    });



</script>
</html>